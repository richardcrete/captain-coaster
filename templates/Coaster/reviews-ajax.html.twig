{% import "helper.html.twig" as helper %}

<div id="coaster-reviews" class="row">
    <!-- Comments -->
    <div class="panel panel-flat">
        <div class="panel-heading">
            <h6 class="panel-title" style="display: flex;justify-content: space-between;flex-wrap: wrap;gap: 10px;">
                <div style="display: flex;gap: 10px;align-items: center;">
                <span class="text-semibold" style="flex-shrink: 0;">
                    <i class="icon-bubble-lines4 position-left"></i> {{ 'review.title'|trans }}
                    &nbsp;<span class="badge bg-primary">{{ reviews.getTotalItemCount() }}</span>
                </span>
                    {% if reviews.getTotalItemCount() > 1 %}
                        <form class="review-list form-horizontal" style="max-width: 150px;">
                            <input type="hidden" name="page" id="filter-page" value="{{ reviews.page|default(1) }}">

                            <div class="form-group-xs no-margin-bottom">
                                <select name="filters[sort]" class="form-control" onchange="loadReviews();"
                                        style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis;">
                                    <option value=""
                                            {% if filters is not null or filters.sort == '' %}selected{% endif %}>
                                        Tri par défaut
                                    </option>
                                    <option value="updatedAt|asc"
                                            {% if filters.sort == 'updatedAt|asc' %}selected{% endif %}>
                                        <i class=""></i>
                                        Du plus ancien au plus récent
                                    </option>
                                    <option value="updatedAt|desc"
                                            {% if filters.sort == 'updatedAt|desc' %}selected{% endif %}>
                                        <i class=""></i>
                                        Du plus récent au plus ancien
                                    </option>
                                    <option value="value|desc" {% if filters.sort == 'value|desc' %}selected{% endif %}>
                                        <i class=""></i>
                                        De la meilleure à la moins bonne note
                                    </option>
                                    <option value="value|asc" {% if filters.sort == 'value|asc' %}selected{% endif %}>
                                        <i class=""></i>
                                        De la moins bonne à la meilleure note
                                    </option>
                                </select>
                            </div>
                        </form>
                    {% endif %}
                </div>
                {% if coaster.isRateable %}
                    <a class="text-muted" href="{{ path('review_form', {'id': coaster.id}) }}">
                        <button type="button" class="btn btn-primary btn-rounded btn-xs"><i
                                class="icon-plus22 position-left"></i> {{ 'review.send'| trans() }}</button>
                    </a>
                {% endif %}
            </h6>

        </div>

        <div class="panel-body mt-5">
            <ul class="media-list media-list-bordered">
                {% for review in reviews %}
                    <li class="media">
                        {% include 'Includes/_review_item.html.twig' with {'review': review, 'displayReviewsInAllLanguages': displayReviewsInAllLanguages} %}
                    </li>
                {% else %}
                    <li class="text-center text-muted">
                        <i class="icon-comment-discussion position-left"></i>
                        {{ 'review_list.no_review'|trans }}
                    </li>
                {% endfor %}
            </ul>
            {{ knp_pagination_render(reviews) }}
        </div>
    </div>
    <!-- /comments -->
</div>
